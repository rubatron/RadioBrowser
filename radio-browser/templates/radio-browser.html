<!--
/*
 * SPDX-License-Identifier: GPL-3.0-or-later
 * Copyright 2014 The moOde audio player project / Tim Curtis
 * moOde Extensions Framework - Radio Browser
 */
-->

<div id="container">
    <div class="container">
        <div class="radio-browser-header">
            <img src="/images/radio-d.svg" alt="Radio Browser Logo" class="radio-browser-logo">
            <h1 class="config-title">Radio Browser</h1>
        </div>
        <p class="config-help-static" style="margin-bottom: 1.5rem;">Search and play internet radio stations from radio-browser.info</p>

        <!-- Recently Played Section - Always visible at top -->
        <fieldset id="rb-recently-played-section">
            <legend>Recently Played</legend>
            <div id="rb-recently-played" class="rb-results-grid">
                <p class="rb-no-results">No recently played stations yet.</p>
            </div>
        </fieldset>

        <!-- Tab Navigation -->
        <div class="rb-tabs">
            <button type="button" class="rb-tab active" data-tab="search">Search Stations</button>
            <button type="button" class="rb-tab" data-tab="settings">Settings</button>
        </div>

        <!-- Search Panel -->
        <div id="rb-search-panel" class="rb-panel">
            <form class="form-horizontal" id="radio-search-form">
                <fieldset>
                    <legend style="display:none;">Search Stations</legend>
                    
                    <div class="control-group">
                        <label class="control-label" for="rb-name">Station Name</label>
                        <div class="controls">
                            <input type="text" id="rb-name" class="input-xlarge" placeholder="e.g. Jazz, Classical, News...">
                            <a class="info-toggle" data-cmd="info-rb-name" href="#notarget"><i class="fa-solid fa-sharp fa-info-circle"></i></a>
                            <span id="info-rb-name" class="config-help-info hide">Search by station name or keywords. Leave empty and use Country/Genre for broader search.</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="rb-country">Country</label>
                        <div class="controls" style="position: relative;">
                            <input type="text" id="rb-country" class="input-medium" placeholder="Type to search..." autocomplete="off">
                            <div id="rb-country-list" class="rb-autocomplete-list hide"></div>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="rb-genre">Genre</label>
                        <div class="controls">
                            <select id="rb-genre" class="input-medium">
                                <option value="">All Genres</option>
                                <option value="jazz">Jazz</option>
                                <option value="classical">Classical</option>
                                <option value="pop">Pop</option>
                                <option value="rock">Rock</option>
                                <option value="electronic">Electronic</option>
                                <option value="ambient">Ambient</option>
                                <option value="blues">Blues</option>
                                <option value="country">Country</option>
                                <option value="folk">Folk</option>
                                <option value="soul">Soul</option>
                                <option value="r&b">R&B</option>
                                <option value="hip hop">Hip Hop</option>
                                <option value="reggae">Reggae</option>
                                <option value="latin">Latin</option>
                                <option value="world">World</option>
                                <option value="news">News</option>
                                <option value="talk">Talk</option>
                                <option value="oldies">Oldies</option>
                                <option value="80s">80s</option>
                                <option value="90s">90s</option>
                            </select>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label"></label>
                        <div class="controls">
                            <button type="submit" class="btn btn-primary">
                                <i class="fa-solid fa-sharp fa-search"></i> Search
                            </button>
                            <button type="button" id="rb-top-stations" class="btn">
                                <i class="fa-solid fa-sharp fa-star"></i> Top Stations
                            </button>
                        </div>
                    </div>
                </fieldset>
            </form>

            <!-- Results -->
            <fieldset id="rb-results-section" class="hide">
                <legend>Results <span id="rb-result-count"></span></legend>
                
                <div id="rb-loading" class="rb-loading hide">
                    <i class="fa-solid fa-sharp fa-spinner fa-spin fa-2x"></i>
                    <p>Searching stations...</p>
                </div>

                <div id="rb-results" class="rb-results-grid"></div>
                
                <div id="rb-no-results" class="rb-no-results hide">
                    <i class="fa-solid fa-sharp fa-radio fa-2x"></i>
                    <p>No stations found. Try a different search.</p>
                </div>

                <div id="rb-pagination" class="rb-pagination hide">
                    <button type="button" id="rb-prev" class="btn btn-small" disabled>
                        <i class="fa-solid fa-sharp fa-chevron-left"></i> Previous
                    </button>
                    <span id="rb-page-info"></span>
                    <button type="button" id="rb-next" class="btn btn-small">
                        Next <i class="fa-solid fa-sharp fa-chevron-right"></i>
                    </button>
                </div>
            </fieldset>
        </div><!-- end rb-search-panel -->

        <!-- Settings Panel -->
        <div id="rb-settings-panel" class="rb-panel hide">

            <!-- API Status Accordion -->
            <div class="rb-accordion">
                <div class="rb-accordion-header">
                    <h4><i class="fa-solid fa-sharp fa-signal"></i> API Status</h4>
                    <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                </div>
                <div class="rb-accordion-content">
                    <div class="rb-accordion-body">
                        <div id="rb-api-status" class="rb-api-status">
                            <div class="rb-status-loading"><i class="fa-solid fa-sharp fa-spinner fa-spin"></i> Checking API status...</div>
                        </div>
                        <button type="button" id="rb-refresh-status" class="btn btn-small" style="margin-top: 0.5rem;"><i class="fa-solid fa-sharp fa-sync"></i> Refresh</button>
                    </div>
                </div>
            </div>

            <!-- API Service Accordion -->
            <div class="rb-accordion">
                <div class="rb-accordion-header">
                    <h4><i class="fa-solid fa-sharp fa-server"></i> API Service</h4>
                    <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                </div>
                <div class="rb-accordion-content">
                    <div class="rb-accordion-body">
                        <form class="form-horizontal" method="post">
                            <div class="control-group">
                                <label class="control-label">Active API</label>
                                <div class="controls">
                                    <select name="radio_api_service" class="input-large">
                                        $_radio_api_options
                                    </select>
                                    <button class="btn btn-primary btn-small" type="submit" name="save_radio_api" value="1"><i class="fa-solid fa-sharp fa-check"></i> Save</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Custom API Accordion -->
            <div class="rb-accordion">
                <div class="rb-accordion-header">
                    <h4><i class="fa-solid fa-sharp fa-plug"></i> Custom API</h4>
                    <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                </div>
                <div class="rb-accordion-content">
                    <div class="rb-accordion-body">
                        <!-- Sub-accordion: Add Custom API -->
                        <div class="rb-sub-accordion">
                            <div class="rb-accordion-header">
                                <h5><i class="fa-solid fa-sharp fa-plus"></i> Add New</h5>
                                <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                            </div>
                            <div class="rb-accordion-content">
                                <div class="rb-accordion-body">
                                    <form class="form-horizontal" method="post">
                                        <div class="control-group">
                                            <label class="control-label">Name</label>
                                            <div class="controls">
                                                <input type="text" name="custom_api_name" class="input-large" placeholder="My Radio API">
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label">URL</label>
                                            <div class="controls">
                                                <input type="url" name="custom_api_url" class="input-xlarge" placeholder="https://api.example.com">
                                            </div>
                                        </div>
                                        <div class="control-group">
                                            <label class="control-label">Type</label>
                                            <div class="controls">
                                                <select name="custom_api_type" class="input-medium">
                                                    <option value="radio-browser">Radio Browser</option>
                                                    <option value="icecast">Icecast</option>
                                                    <option value="shoutcast">Shoutcast</option>
                                                </select>
                                                <button class="btn btn-primary btn-small" type="submit" name="add_custom_api" value="1"><i class="fa-solid fa-sharp fa-plus"></i> Add</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Sub-accordion: Remove Custom API -->
                        <div class="rb-sub-accordion">
                            <div class="rb-accordion-header">
                                <h5><i class="fa-solid fa-sharp fa-trash"></i> Remove Existing</h5>
                                <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                            </div>
                            <div class="rb-accordion-content">
                                <div class="rb-accordion-body">
                                    <form class="form-horizontal" method="post" onsubmit="return confirm('Remove this custom API?');">
                                        <div class="control-group">
                                            <label class="control-label">Service</label>
                                            <div class="controls">
                                                <select name="custom_api_to_remove" class="input-large">
                                                    $_custom_api_options
                                                </select>
                                                <button class="btn btn-small" type="submit" name="remove_custom_api" value="1"><i class="fa-solid fa-sharp fa-trash"></i> Remove</button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Extension Info Accordion -->
            <div class="rb-accordion">
                <div class="rb-accordion-header">
                    <h4><i class="fa-solid fa-sharp fa-info-circle"></i> Extension Info</h4>
                    <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                </div>
                <div class="rb-accordion-content">
                    <div class="rb-accordion-body">
                        <div class="rb-info-grid">
                            <div class="rb-info-item">
                                <span class="rb-info-label">Version</span>
                                <span class="rb-info-value">1.0.0</span>
                            </div>
                            <div class="rb-info-item">
                                <span class="rb-info-label">Author</span>
                                <span class="rb-info-value">moOde audio player</span>
                            </div>
                            <div class="rb-info-item">
                                <span class="rb-info-label">License</span>
                                <span class="rb-info-value">GPL-3.0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Troubleshooting Accordion -->
            <div class="rb-accordion">
                <div class="rb-accordion-header">
                    <h4><i class="fa-solid fa-sharp fa-wrench"></i> Troubleshooting</h4>
                    <i class="fa-solid fa-sharp fa-chevron-down rb-accordion-icon"></i>
                </div>
                <div class="rb-accordion-content">
                    <div class="rb-accordion-body">
                        <p class="rb-help-text" style="margin-bottom: 1rem; color: #888;">Use these tools to fix common issues with the Radio Browser extension.</p>
                        
                        <div class="rb-troubleshoot-actions">
                            <div class="rb-action-item">
                                <button type="button" id="rb-flush-cache" class="btn btn-small">
                                    <i class="fa-solid fa-sharp fa-trash-can"></i> Flush Cache
                                </button>
                                <span class="rb-action-desc">Clear cached API responses and images</span>
                            </div>
                            
                            <div class="rb-action-item">
                                <button type="button" id="rb-restart-services" class="btn btn-small">
                                    <i class="fa-solid fa-sharp fa-rotate"></i> Restart Services
                                </button>
                                <span class="rb-action-desc">Restart nginx and PHP-FPM</span>
                            </div>
                            
                            <div class="rb-action-item">
                                <button type="button" id="rb-view-log" class="btn btn-small">
                                    <i class="fa-solid fa-sharp fa-file-lines"></i> View Log
                                </button>
                                <span class="rb-action-desc">Show recent debug log entries</span>
                            </div>
                            
                            <div class="rb-action-item">
                                <button type="button" id="rb-clear-log" class="btn btn-small">
                                    <i class="fa-solid fa-sharp fa-eraser"></i> Clear Log
                                </button>
                                <span class="rb-action-desc">Clear the debug log file</span>
                            </div>
                            
                            <div class="rb-action-item rb-action-danger">
                                <button type="button" id="rb-reboot-system" class="btn btn-small btn-danger">
                                    <i class="fa-solid fa-sharp fa-power-off"></i> Reboot System
                                </button>
                                <span class="rb-action-desc">Reboot the moOde system</span>
                            </div>
                        </div>
                        
                        <div id="rb-log-output" class="rb-log-output hide">
                            <pre></pre>
                        </div>
                    </div>
                </div>
            </div>

        </div><!-- end rb-settings-panel -->

    </div>
</div>
